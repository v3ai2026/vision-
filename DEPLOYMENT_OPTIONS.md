# Railway éƒ¨ç½²é€‰é¡¹æ€»è§ˆ (Railway Deployment Options Overview)

## ğŸ¯ éƒ¨ç½²æ¶æ„é€‰æ‹©

æœ¬ä»“åº“æ”¯æŒä¸¤ç§ Railway éƒ¨ç½²æ¶æ„ï¼š

### é€‰é¡¹ 1: å•ä»“åº“éƒ¨ç½² (Monorepo Deployment) âœ… æ¨èå¿«é€Ÿå¼€å§‹

å‰ç«¯å’Œåç«¯åœ¨åŒä¸€ä»“åº“ï¼Œä¸€èµ·éƒ¨ç½²ã€‚

**ä¼˜ç‚¹:**
- ç®€å•å¿«é€Ÿ
- ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†
- é€‚åˆå°å›¢é˜Ÿ

**é€‚ç”¨åœºæ™¯:**
- å¿«é€ŸåŸå‹å¼€å‘
- å°å‹é¡¹ç›®
- å•äººæˆ–å°å›¢é˜Ÿå¼€å‘

### é€‰é¡¹ 2: åˆ†ç¦»ä»“åº“éƒ¨ç½² (Separate Repositories) âœ… æ¨èç”Ÿäº§ç¯å¢ƒ

å‰ç«¯å’Œåç«¯åœ¨ç‹¬ç«‹ä»“åº“ï¼Œåˆ†åˆ«éƒ¨ç½²ã€‚

**ä¼˜ç‚¹:**
- ç‹¬ç«‹ç‰ˆæœ¬æ§åˆ¶
- å›¢é˜Ÿåˆ†å·¥åä½œ
- ç‹¬ç«‹çš„ CI/CD
- æ›´å¥½çš„æƒé™ç®¡ç†

**é€‚ç”¨åœºæ™¯:**
- ç”Ÿäº§ç¯å¢ƒ
- å¤§å‹é¡¹ç›®
- å¤šå›¢é˜Ÿåä½œ
- éœ€è¦ç‹¬ç«‹æ‰©å±•

## ğŸ“š å¿«é€Ÿå¯¼èˆª

### 1. å•ä»“åº“éƒ¨ç½² (Monorepo)

**æ–‡æ¡£:**
- ğŸ“– [å®Œæ•´éƒ¨ç½²æŒ‡å—](./RAILWAY_DEPLOYMENT_GUIDE.md)
- ğŸ¤– [è‡ªåŠ¨éƒ¨ç½²é…ç½®](./RAILWAY_AUTO_DEPLOY.md)
- ğŸ” [å¿«é€Ÿå‚è€ƒ](./RAILWAY_QUICK_REFERENCE.md)

**å¿«é€Ÿå¼€å§‹:**
```bash
# è‡ªåŠ¨éƒ¨ç½²æ‰€æœ‰æœåŠ¡
./railway-deploy.sh        # Linux/Mac
railway-deploy.bat         # Windows
```

**æ‰‹åŠ¨éƒ¨ç½²:**
```bash
# å®‰è£… Railway CLI
npm install -g @railway/cli

# ç™»å½•
railway login

# éƒ¨ç½²å‰ç«¯
railway up --service frontend

# éƒ¨ç½²åç«¯æœåŠ¡
cd server/blade-gateway && railway up --service blade-gateway
```

### 2. åˆ†ç¦»ä»“åº“éƒ¨ç½² (Separate Repositories)

**æ–‡æ¡£:**
- ğŸ“– [åç«¯åˆ†ç¦»æŒ‡å—](./BACKEND_SEPARATION_GUIDE.md)
- ğŸ” [å¿«é€Ÿå‚è€ƒ](./BACKEND_SEPARATION_QUICK_REF.md)

**å¿«é€Ÿå¼€å§‹:**
```bash
# è¿è¡Œåˆ†ç¦»è„šæœ¬
./separate-backend.sh      # Linux/Mac
separate-backend.bat       # Windows
```

**æ‰‹åŠ¨åˆ†ç¦»æ­¥éª¤:**
1. åœ¨ GitHub åˆ›å»ºæ–°ä»“åº“ `vision-backend`
2. è¿è¡Œåˆ†ç¦»è„šæœ¬
3. ä»å½“å‰ä»“åº“åˆ é™¤ `server/` ç›®å½•
4. åˆ†åˆ«é…ç½® Railway é¡¹ç›®

## ğŸ—‚ï¸ æ–‡ä»¶ç»“æ„è¯´æ˜

### é…ç½®æ–‡ä»¶æ¸…å•:

```
vision-/ (å½“å‰ä»“åº“)
â”œâ”€â”€ å‰ç«¯é…ç½®
â”‚   â”œâ”€â”€ nixpacks.toml              # å‰ç«¯æ„å»ºé…ç½®
â”‚   â”œâ”€â”€ railway.json               # å‰ç«¯ Railway é…ç½®
â”‚   â””â”€â”€ package.json               # åŒ…å« start è„šæœ¬
â”‚
â”œâ”€â”€ åç«¯é…ç½®
â”‚   â””â”€â”€ server/
â”‚       â”œâ”€â”€ blade-gateway/
â”‚       â”‚   â”œâ”€â”€ nixpacks.toml      # åç«¯æœåŠ¡æ„å»ºé…ç½®
â”‚       â”‚   â””â”€â”€ railway.json       # åç«¯æœåŠ¡ Railway é…ç½®
â”‚       â”œâ”€â”€ blade-auth/
â”‚       â”‚   â”œâ”€â”€ nixpacks.toml
â”‚       â”‚   â””â”€â”€ railway.json
â”‚       â””â”€â”€ ... (å…¶ä»–æœåŠ¡)
â”‚
â”œâ”€â”€ è‡ªåŠ¨éƒ¨ç½²
â”‚   â”œâ”€â”€ .github/workflows/
â”‚   â”‚   â””â”€â”€ railway-deploy.yml     # GitHub Actions å·¥ä½œæµ
â”‚   â”œâ”€â”€ railway-template.yml       # ä¸€é”®éƒ¨ç½²æ¨¡æ¿
â”‚   â”œâ”€â”€ railway-deploy.sh          # Linux/Mac éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ railway-deploy.bat         # Windows éƒ¨ç½²è„šæœ¬
â”‚
â”œâ”€â”€ åç«¯åˆ†ç¦»å·¥å…·
â”‚   â”œâ”€â”€ separate-backend.sh        # Linux/Mac åˆ†ç¦»è„šæœ¬
â”‚   â””â”€â”€ separate-backend.bat       # Windows åˆ†ç¦»è„šæœ¬
â”‚
â””â”€â”€ æ–‡æ¡£
    â”œâ”€â”€ RAILWAY_DEPLOYMENT_GUIDE.md          # å®Œæ•´éƒ¨ç½²æŒ‡å—
    â”œâ”€â”€ RAILWAY_AUTO_DEPLOY.md               # è‡ªåŠ¨éƒ¨ç½²æ–‡æ¡£
    â”œâ”€â”€ RAILWAY_QUICK_REFERENCE.md           # å¿«é€Ÿå‚è€ƒ
    â”œâ”€â”€ BACKEND_SEPARATION_GUIDE.md          # åç«¯åˆ†ç¦»æŒ‡å—
    â”œâ”€â”€ BACKEND_SEPARATION_QUICK_REF.md      # åˆ†ç¦»å¿«é€Ÿå‚è€ƒ
    â””â”€â”€ DEPLOYMENT_COMPLETE_SUMMARY.md       # éƒ¨ç½²å®Œæˆæ€»ç»“
```

## ğŸš€ å¿«é€Ÿå†³ç­–æŒ‡å—

### æˆ‘åº”è¯¥é€‰æ‹©å“ªç§éƒ¨ç½²æ–¹å¼ï¼Ÿ

**é€‰æ‹©å•ä»“åº“ (Monorepo) å¦‚æœ:**
- âœ… æ‚¨æ˜¯å•äººå¼€å‘æˆ–å°å›¢é˜Ÿ (< 5 äºº)
- âœ… é¡¹ç›®å¤„äºæ—©æœŸé˜¶æ®µ/åŸå‹å¼€å‘
- âœ… å‰åç«¯ç´§å¯†è€¦åˆï¼ŒåŒæ­¥å¼€å‘
- âœ… å¸Œæœ›å¿«é€Ÿéƒ¨ç½²å’Œæµ‹è¯•
- âœ… ä¸éœ€è¦å¤æ‚çš„æƒé™ç®¡ç†

**é€‰æ‹©åˆ†ç¦»ä»“åº“ (Separate Repos) å¦‚æœ:**
- âœ… å¤šä¸ªå›¢é˜Ÿåˆ†åˆ«è´Ÿè´£å‰åç«¯
- âœ… é¡¹ç›®è¿›å…¥ç”Ÿäº§é˜¶æ®µ
- âœ… éœ€è¦ç‹¬ç«‹çš„å‘å¸ƒå‘¨æœŸ
- âœ… å‰åç«¯æŠ€æœ¯æ ˆå·®å¼‚å¤§
- âœ… éœ€è¦ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶
- âœ… è®¡åˆ’ç‹¬ç«‹æ‰©å±•å‰åç«¯

## ğŸ“‹ éƒ¨ç½²æ¸…å•

### å•ä»“åº“éƒ¨ç½²æ¸…å•:

- [ ] åœ¨ Railway åˆ›å»ºé¡¹ç›®
- [ ] è¿æ¥ GitHub ä»“åº“
- [ ] é…ç½®å‰ç«¯æœåŠ¡ (Root: `/`)
- [ ] é…ç½®åç«¯æœåŠ¡ (Root: `server/xxx`)
- [ ] æ·»åŠ  PostgreSQL æ•°æ®åº“
- [ ] è®¾ç½®ç¯å¢ƒå˜é‡
- [ ] æµ‹è¯•éƒ¨ç½²

### åˆ†ç¦»ä»“åº“éƒ¨ç½²æ¸…å•:

**å‡†å¤‡é˜¶æ®µ:**
- [ ] åœ¨ GitHub åˆ›å»º `vision-backend` ä»“åº“
- [ ] è¿è¡Œåç«¯åˆ†ç¦»è„šæœ¬
- [ ] éªŒè¯æ–°åç«¯ä»“åº“
- [ ] ä»å‰ç«¯ä»“åº“åˆ é™¤ `server/`

**Railway é…ç½®:**
- [ ] åˆ›å»ºå‰ç«¯ Railway é¡¹ç›®
- [ ] åˆ›å»ºåç«¯ Railway é¡¹ç›®
- [ ] é…ç½®å‰ç«¯æœåŠ¡
- [ ] é…ç½®æ‰€æœ‰åç«¯æœåŠ¡
- [ ] æ·»åŠ  PostgreSQL æ•°æ®åº“
- [ ] è®¾ç½®ç¯å¢ƒå˜é‡
- [ ] é…ç½® CORS
- [ ] æµ‹è¯• API é€šä¿¡

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

### å‰ç«¯ç¯å¢ƒå˜é‡:

**å•ä»“åº“:**
```bash
# Railway è‡ªåŠ¨å¤„ç†å†…éƒ¨é€šä¿¡
PORT=${{RAILWAY_PUBLIC_PORT}}
```

**åˆ†ç¦»ä»“åº“:**
```bash
PORT=${{RAILWAY_PUBLIC_PORT}}
VITE_API_GATEWAY_URL=https://your-gateway.railway.app
```

### åç«¯ç¯å¢ƒå˜é‡:

```bash
PORT=${{RAILWAY_PUBLIC_PORT}}
DATABASE_URL=${{Postgres.DATABASE_URL}}
DB_USERNAME=postgres
DB_PASSWORD=${{Postgres.POSTGRES_PASSWORD}}

# ç‰¹å®šæœåŠ¡
JWT_SECRET=your-secret           # blade-auth
STRIPE_API_KEY=sk_test_...       # vision-payment
```

## ğŸ› ï¸ å·¥å…·å’Œè„šæœ¬

### éƒ¨ç½²è„šæœ¬:

| è„šæœ¬ | ç”¨é€” | å¹³å° |
|------|------|------|
| `railway-deploy.sh` | éƒ¨ç½²æ‰€æœ‰æœåŠ¡ | Linux/Mac |
| `railway-deploy.bat` | éƒ¨ç½²æ‰€æœ‰æœåŠ¡ | Windows |
| `separate-backend.sh` | åˆ†ç¦»åç«¯ä»£ç  | Linux/Mac |
| `separate-backend.bat` | åˆ†ç¦»åç«¯ä»£ç  | Windows |

### GitHub Actions:

| æ–‡ä»¶ | è§¦å‘æ¡ä»¶ | ç”¨é€” |
|------|---------|------|
| `.github/workflows/railway-deploy.yml` | Push to main | è‡ªåŠ¨éƒ¨ç½²æ‰€æœ‰æœåŠ¡ |

### Railway æ¨¡æ¿:

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `railway-template.yml` | ä¸€é”®éƒ¨ç½²æ‰€æœ‰æœåŠ¡ |

## ğŸ“Š éƒ¨ç½²æ¶æ„å¯¹æ¯”

| ç‰¹æ€§ | å•ä»“åº“ | åˆ†ç¦»ä»“åº“ |
|------|--------|----------|
| è®¾ç½®å¤æ‚åº¦ | â­â­ ç®€å• | â­â­â­â­ å¤æ‚ |
| ç‰ˆæœ¬ç®¡ç† | ç»Ÿä¸€ç‰ˆæœ¬ | ç‹¬ç«‹ç‰ˆæœ¬ |
| å›¢é˜Ÿåä½œ | é€‚åˆå°å›¢é˜Ÿ | é€‚åˆå¤§å›¢é˜Ÿ |
| CI/CD | å•ä¸€æµç¨‹ | ç‹¬ç«‹æµç¨‹ |
| éƒ¨ç½²é€Ÿåº¦ | å¿«é€Ÿ | è¾ƒæ…¢ |
| å¯æ‰©å±•æ€§ | å—é™ | çµæ´» |
| æƒé™æ§åˆ¶ | åŸºç¡€ | ç»†ç²’åº¦ |
| ç»´æŠ¤æˆæœ¬ | ä½ | ä¸­ç­‰ |

## ğŸ“ æœ€ä½³å®è·µ

### å¼€å‘é˜¶æ®µå»ºè®®:

1. **åŸå‹é˜¶æ®µ**: ä½¿ç”¨å•ä»“åº“ï¼Œå¿«é€Ÿè¿­ä»£
2. **MVP é˜¶æ®µ**: ç»§ç»­å•ä»“åº“ï¼Œä¸“æ³¨åŠŸèƒ½
3. **ç”Ÿäº§å‡†å¤‡**: è€ƒè™‘åˆ†ç¦»ä»“åº“
4. **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨åˆ†ç¦»ä»“åº“ï¼Œç‹¬ç«‹éƒ¨ç½²

### å›¢é˜Ÿè§„æ¨¡å»ºè®®:

- **1-3 äºº**: å•ä»“åº“
- **4-10 äºº**: å•ä»“åº“æˆ–å¼€å§‹åˆ†ç¦»
- **10+ äºº**: åˆ†ç¦»ä»“åº“

### è¿ç§»è·¯å¾„:

```
é˜¶æ®µ 1: å•ä»“åº“å¼€å‘
    â†“
é˜¶æ®µ 2: åŠŸèƒ½ç¨³å®š
    â†“
é˜¶æ®µ 3: è¿è¡Œåˆ†ç¦»è„šæœ¬
    â†“
é˜¶æ®µ 4: åˆ†ç¦»ä»“åº“éƒ¨ç½²
    â†“
é˜¶æ®µ 5: é€æ­¥è¿ç§»æµé‡
```

## ğŸ†˜ è·å–å¸®åŠ©

### å•ä»“åº“éƒ¨ç½²é—®é¢˜:
- ğŸ“– æŸ¥çœ‹ [RAILWAY_DEPLOYMENT_GUIDE.md](./RAILWAY_DEPLOYMENT_GUIDE.md)
- ğŸ” å‚è€ƒ [RAILWAY_QUICK_REFERENCE.md](./RAILWAY_QUICK_REFERENCE.md)

### åˆ†ç¦»ä»“åº“é—®é¢˜:
- ğŸ“– æŸ¥çœ‹ [BACKEND_SEPARATION_GUIDE.md](./BACKEND_SEPARATION_GUIDE.md)
- ğŸ” å‚è€ƒ [BACKEND_SEPARATION_QUICK_REF.md](./BACKEND_SEPARATION_QUICK_REF.md)

### è‡ªåŠ¨éƒ¨ç½²é—®é¢˜:
- ğŸ“– æŸ¥çœ‹ [RAILWAY_AUTO_DEPLOY.md](./RAILWAY_AUTO_DEPLOY.md)

## ğŸ“ æ”¯æŒæ¸ é“

1. æŸ¥çœ‹ç›¸å…³æ–‡æ¡£
2. æ£€æŸ¥ Railway Dashboard æ—¥å¿—
3. æŸ¥çœ‹ GitHub Actions è¿è¡Œæ—¥å¿—
4. æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®

---

**é€‰æ‹©é€‚åˆæ‚¨é¡¹ç›®çš„éƒ¨ç½²æ–¹å¼ï¼Œç„¶åå‚è€ƒå¯¹åº”çš„æ–‡æ¡£å¼€å§‹éƒ¨ç½²ï¼**

**æ›´æ–°æ—¶é—´**: 2025-12-26
